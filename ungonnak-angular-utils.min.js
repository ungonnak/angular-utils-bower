/*! ungonnak-angular-utils 05-05-2016 */
angular.module('ungonnak-angular-utils', ['uau.templates','uau.canSubmit','uau.currency','uau.feedbackIcon','uau.hasFeedback','uau.helpers','uau.matchValidator','uau.showValidationMessages','uau.uniqueValidator']);
angular.module('uau.templates', ['uau/templates/feedback-icon.html']);
angular.module("uau.canSubmit",[]).directive("canSubmit",["$timeout",function(){function a(a,b,c){function d(a){a.$invalid?f.prop("disabled",!0):f.prop("disabled",!1)}function e(a){for(var b in a)a.hasOwnProperty(b)&&a[b]&&a[b].$setTouched&&a[b].$validate&&(a[b].$validate(),a[b].$setTouched(),delete a[b].$error.server)}var f=angular.element(b);void 0!==c.triggerValidation?f.on("click",function(){e(a.canSubmit)}):a.$watchCollection(function(){return a.canSubmit},d)}return{restrict:"A",link:a,scope:{canSubmit:"="}}}]),angular.module("uau.currency",[]).directive("currency",["$filter",function(a){function b(b,c,d,e){function f(b){return a("currency")(b,"")}function g(a){var b=0,c=a.toString().replace(/\D+/g,""),d=c.substring(0,c.length-h),g=c.substring(c.length-g);return g.length<h&&(g=new Array(h-g.length+1).join(0),g+=g),b=Number(d+"."+g),e.$viewValue=f(b),e.$render(),b}var h=d.decimalPlaces?d.decimalPlaces:2;e.$formatters.push(f),e.$parsers.push(g)}return{require:"ngModel",restrict:"A",link:b}}]),angular.module("uau.feedbackIcon",[]).directive("feedbackIcon",function(){function a(a,b,c){function d(a){function b(){e.removeClass("glyphicon-warning"),e.removeClass("glyphicon-remove"),e.removeClass("glyphicon-ok"),c.initial&&e.removeClass(c.initial)}a&&(b(),a.$invalid&&(a.$touched||a.$dirty)?e.addClass("glyphicon-remove"):a.$valid?e.addClass("glyphicon-ok"):c.initial&&e.addClass(c.initial))}var e=angular.element(b);a.$watchCollection(c["for"],d)}return{restrict:"E",replace:!0,templateUrl:"uau/templates/feedback-icon.html",link:a}}),angular.module("uau.hasFeedback",[]).directive("hasFeedback",function(){function a(a,b,c){function d(a){function b(){e.removeClass("has-error"),e.removeClass("has-success"),e.removeClass("has-warning"),c.initialFeedback&&e.removeClass(c.initialFeedback)}a&&(b(),a.$invalid&&(a.$touched||a.$dirty)?e.addClass("has-error"):a.$valid?e.addClass("has-success"):c.initialFeedback&&e.addClass(c.initialFeedback))}var e=angular.element(b);e.hasClass(".has-feedback")||e.addClass("has-feedback"),a.$watchCollection(c["for"],d)}return{restrict:"A",link:a}}),angular.module("uau.helpers",[]).factory("uauHelpers",["$rootScope",function(a){function b(a,b,d){function e(a){for(var c in a)f(b[c],a[c])}function f(a,b){a&&a.hasOwnProperty("$invalid")&&a.hasOwnProperty("$error")&&(a.$invalid=!0,a.$error.server=b),d&&d.push(b)}var g=c(a);for(var h in g)g[h]instanceof Object?e(g[h]):f(b[h],g[h])}function c(a){var b={};for(var c in a){var d,e=a[c];e instanceof Array&&1==e.length&&(e=e[0]),c.indexOf(".")>=0?(d=c.split("."),b[d[0]]||(b[d[0]]={}),b[d[0]][d[1]]=e):b[c]=e}return b}return{applyServerValidationMessages:b,filterValidationResponse:c}}]),angular.module("uau.matchValidator",[]).directive("match",function(){function a(a,b,c,d){function e(a,b){return f.val()===g.val()}var f=angular.element(b),g=angular.element("#"+c.match);f.on("keyup",function(){a.$apply(function(){""===g.val()&&d.$setValidity("match",!0),""!==f.val()&&d.$validate()})}),d.$validators.match=e,c.$observe("match",function(){d.$validate()})}return{require:"ng-model",link:a}}),angular.module("uau.showValidationMessages",["ngMessages"]).directive("showValidationMessages",function(){function a(a,b,c){function d(a){a&&((a.$dirty||a.$touched)&&Object.keys(a.$error).length>0?e.show():e.hide())}var e=angular.element(b);a.$watchCollection(c.of,d)}return{require:"ngMessages",restrict:"A",link:a}}),angular.module("uau.uniqueValidator",[]).directive("unique",["$http","$timeout",function(a,b){function c(c,d,e,f){function g(c,d){function g(){function b(a){f.$setValidity("unique",a.data.status),a.data.message&&(f.$error.uniqe=a.data.message)}a({method:"GET",url:"/api/ajaxValidation/unique",params:{model:e.unique,field:f.$name,value:c,ignore:e.ignore||null}}).then(b)}return i.is("input")?i.on("keyup",function(){b.cancel(h),h=b(g,500)}):g(),!0}if(f){var h,i=angular.element(d);f.$validators.unique=g,e.$observe("unique",function(){f.$validate()})}}return{require:"?ngModel",restrict:"A",link:c}}]),angular.module("uau/templates/feedback-icon.html",[]).run(["$templateCache",function(a){a.put("uau/templates/feedback-icon.html",'<span class="form-control-feedback glyphicon" aria-hidden="true"></span>\n')}]);
